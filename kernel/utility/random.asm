; *****************************************************************************
; *****************************************************************************
;
;		Name:		random.asm
;		Purpose:	Simple 16 bit PRNG.
;		Created:	8th March 2020
;		Reviewed: 	16th March 2020
;		Author:		Paul Robson (paul@robsons.org.uk)
;
; *****************************************************************************
; *****************************************************************************

; *****************************************************************************
;
;				16 bit LFSR / timer random number generator.
;
; *****************************************************************************

.OSXRandom16
		push 	r1

		ldm 	r0,#randomSeed

		mov 	r1,r0,#0
		ror 	r0,#9
		and 	r0,#$FF80
		xor 	r0,r1,#0

		mov 	r1,r0,#0
		ror 	r0,#7
		and 	r0,#$01FF
		xor 	r0,r1,#0

		mov 	r1,r0,#0
		ror 	r0,#8
		and 	r0,#$FF00
		xor 	r0,r1,#0

		stm 	r0,#randomSeed

		pop 	r1
		ret

; *****************************************************************************
;
;								Set the random seed
;
; *****************************************************************************

.OSXRandomSeed
		stm 	r0,#randomSeed
		ret
